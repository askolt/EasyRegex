В обычном regex все параметры перечисляются прямо в шаблоне. Это порождает сложность написания необходимых конструкций. Я решил вынести параметры за пределы шаблона и оформить их как свойства объекта Rule. 